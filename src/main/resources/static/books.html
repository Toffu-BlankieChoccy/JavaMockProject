<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book List</title>
    <style>
        ul { list-style-type: none; padding: 0; }
        li { margin: 10px 0; }
        .pagination { margin-top: 10px; }
        button { margin: 0 5px; }
    </style>
</head>
<body>
<h1>Book List</h1>
<input type="text" id="searchInput" placeholder="Search by title...">
<button onclick="searchBooks()">Search</button>
<div id="bookList"></div>
<div class="pagination" id="pagination"></div>

<script>
    let currentPage = 0;
    const pageSize = 5;

    function fetchBooks(page) {
        fetch(`/api/books?page=${page}&size=${pageSize}`)
            .then(response => {
                if (!response.ok) throw new Error('Network response was not ok');
                return response.json();
            })
            .then(data => {
                const books = data.content;
                let html = '<ul>';
                books.forEach(book => {
                    html += `<li>${book.title} - $${book.price} (ISBN: ${book.isbn})</li>`;
                });
                html += '</ul>';
                document.getElementById('bookList').innerHTML = html;

                // Update pagination
                updatePagination(data.totalPages, page);
            })
            .catch(error => console.error('Error fetching books:', error));
    }

    function searchBooks() {
        const keyword = document.getElementById('searchInput').value;
        fetch(`/api/books/search?keyword=${keyword}&page=0&size=${pageSize}`)
            .then(response => response.json())
            .then(data => {
                const books = data.content;
                let html = '<ul>';
                books.forEach(book => {
                    html += `<li>${book.title} - $${book.price} (ISBN: ${book.isbn})</li>`;
                });
                html += '</ul>';
                document.getElementById('bookList').innerHTML = html;
                updatePagination(data.totalPages, 0);
            })
            .catch(error => console.error('Error:', error));
    }

    function updatePagination(totalPages, currentPage) {
        let paginationHtml = '<button onclick="fetchBooks(0)">First</button>';
        for (let i = 0; i < totalPages; i++) {
            paginationHtml += `<button onclick="fetchBooks(${i})" ${i === currentPage ? 'style="font-weight:bold"' : ''}>${i + 1}</button>`;
        }
        paginationHtml += `<button onclick="fetchBooks(${totalPages - 1})">Last</button>`;
        document.getElementById('pagination').innerHTML = paginationHtml;
    }

    // Load books after fetched
    window.onload = () => fetchBooks(currentPage);
</script>
</body>
</html>